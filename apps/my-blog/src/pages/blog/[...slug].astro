---
import PostDetailPage from '@chenenpei/astro-md-theme/templates/PostDetailPage.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import { SITE } from '../../config';

export async function getStaticPaths() {
  const blogPosts = await getCollection('blog');
  
  return Promise.all(blogPosts.map(async (post: CollectionEntry<'blog'>) => {
    const { Content } = await post.render();
    return {
      params: { slug: post.slug },
      props: { 
        post: {
          slug: post.slug,
          title: post.data.title,
          date: post.data.pubDate,
          category: post.data.category,
          readingTime: post.data.readingTime,
          coverImage: post.data.coverImage || post.data.heroImage,
          coverImageAlt: post.data.coverImageAlt,
        },
        content: Content
      },
    };
  }));
}

const { post, content: Content } = Astro.props;
---

<PostDetailPage
  siteTitle={SITE.title}
  title={post.title}
  date={post.date}
  category={post.category}
  readingTime={post.readingTime}
  coverImage={post.coverImage}
  coverImageAlt={post.coverImageAlt}
  slug={post.slug}
>
  <Content />
</PostDetailPage>

